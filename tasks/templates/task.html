{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo App</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Stats Section -->
      <div class="stats-container">
        <div class="details">
          <h1>To-do List</h1>
          <p>Get 'em done!</p>
          <div class="progressBar">
            <div id="progress" class="progress"></div>
          </div>
        </div>
        <div class="stats-numbers">
          <p id="numbers" class="numbers">0 / 0</p>
        </div>
      </div>

      <!-- Task Input Form -->
      <form action="{% url 'task' %}" method="post">
        {% csrf_token %}
        <div class="task-form">
          <input
            id="taskInput"
            type="text"
            name="inputtask"
            placeholder="Add in a new task"
            required
          />
          <button id="newTask" type="submit" class="btn">+</button>
        </div>

        <!-- Category Selection -->
        <div class="options">
          <h4>Pick a category</h4>
          <div class="category-labels">
            <label>
              <input
                type="radio"
                name="category"
                id="category1"
                value="business"
                required
              />
              <span class="bubble business"></span>
              <div>Homework</div>
            </label>
            <label>
              <input
                type="radio"
                name="category"
                id="category2"
                value="personal"
                required
              />
              <span class="bubble personal"></span>
              <div>Personal</div>
            </label>
          </div>
        </div>
      </form>

      <!-- Task List -->
      <ul id="task-list" class="task-list">
        {% for x in task %}
        <li class="taskItem" data-index="{{ forloop.counter0 }}">
          <!-- Checkbox and Task Text -->
          <div class="task">
            <input
              type="checkbox"
              class="task-checkbox {% if x.category == 'business' %}business{% elif x.category == 'personal' %}personal{% endif %}"
              {%
              if
              x.completed
              %}checked{%
              endif
              %}
            />
            <span class="{% if x.completed %}completed{% endif %}">
              {{ x.tasklist }}
            </span>
          </div>

          <!-- Edit and Delete Buttons -->
          <div class="task-actions">
            <!-- Edit Button -->
            <a href="{% url 'update' x.id %}">
              <img
                src="{% static 'images/edit.png' %}"
                alt="Edit Task"
                class="action-icon"
              />
            </a>

            <!-- Delete Button -->
            <a
              href="{% url 'delete' x.id %}"
              onclick="return confirm('Are you sure you want to delete this task?');"
            >
              <img
                src="{% static 'images/bin.png' %}"
                alt="Delete Task"
                class="action-icon"
              />
            </a>
          </div>
        </li>
        {% empty %}
        <p>No tasks yet. Add a new task above!</p>
        {% endfor %}
      </ul>
    </div>

    <script src="{% static 'js/script.js' %}"></script>
  </body>
</html>
